<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>smartsolve.preprocessing &mdash; smartsolve 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            smartsolve
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">smartsolve</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">smartsolve</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">smartsolve.preprocessing</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for smartsolve.preprocessing</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">smartsolve.models</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">smartsolve.evaluation</span> <span class="kn">import</span> <span class="n">Validation</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f_oneway</span><span class="p">,</span> <span class="n">chi2_contingency</span>



<div class="viewcode-block" id="AnalyseData"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.AnalyseData">[docs]</a><span class="k">class</span> <span class="nc">AnalyseData</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the AnalyseData class.</span>
<span class="sd">        parameters:</span>

<span class="sd">        :param data: Path to the CSV file containing the data.</span>
<span class="sd">        output:</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>




<div class="viewcode-block" id="AnalyseData.load_data"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.AnalyseData.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load the data from the provided CSV file.</span>

<span class="sd">        :return: Loaded data as a Pandas DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span></div>





<div class="viewcode-block" id="AnalyseData.infos"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.AnalyseData.infos">[docs]</a>    <span class="k">def</span> <span class="nf">infos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display information about the data.</span>

<span class="sd">        :return: Data information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data_infos</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data_infos</span></div>





<div class="viewcode-block" id="AnalyseData.stats"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.AnalyseData.stats">[docs]</a>    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform statistical analysis on the columns in the data.</span>

<span class="sd">        Analyzes each column and provides statistical information such as mean, standard deviation, etc.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;int64&#39;</span> <span class="ow">or</span> <span class="n">column</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;float64&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> is a numerical column.&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">column</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span> <span class="ow">or</span> <span class="n">column</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;category&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> is a categorical column.&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This column </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> is not numerical or categorical!&quot;</span><span class="p">)</span></div>





<div class="viewcode-block" id="AnalyseData.heat_map"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.AnalyseData.heat_map">[docs]</a>    <span class="k">def</span> <span class="nf">heat_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a heatmap to visualize the correlation between numeric columns.</span>

<span class="sd">        :param columns: List of columns to consider for the heatmap.</span>
<span class="sd">        :return: Matplotlib heatmap plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>  <span class="c1"># Extract specified columns</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span>

        <span class="n">numeric_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">)</span>
        <span class="n">heatmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">numeric_data</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">heatmap</span></div></div>






<div class="viewcode-block" id="SplitData"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SplitData">[docs]</a><span class="k">class</span> <span class="nc">SplitData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Splits input data into training, validation, and test sets using various methods.</span>

<span class="sd">    :param data: Input data in the form of [(y1,[x11,x12,...,x1n]),(y2,[x21,x22,x2n]),...,(ym,[xm1,xm2,...,xmn])].</span>
<span class="sd">    :param method: The splitting method to use (&#39;Random&#39;, &#39;Stratified&#39;, &#39;TimeSeries&#39;, or &#39;KFold&#39;).</span>
<span class="sd">    :param train: Fraction of data for training (default is 0.8).</span>
<span class="sd">    :param validation: Fraction of data for validation (default is None).</span>
<span class="sd">    :param test: Fraction of data for testing (default is 0.2).</span>
<span class="sd">    :param date: List of date values for time series splitting (default is None).</span>
<span class="sd">    :param num_folds: Number of folds for cross-validation (default is 10).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Random&#39;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">validation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_folds</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation</span> <span class="o">=</span> <span class="n">validation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test</span> <span class="o">=</span> <span class="n">test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">date</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_folds</span> <span class="o">=</span> <span class="n">num_folds</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>







    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call method to initiate data splitting based on the selected method.</span>

<span class="sd">        :return: Training, validation, and test data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;Random&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;Stratified&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stratified</span><span class="p">()</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;TimeSeries&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_series</span><span class="p">()</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;KFold&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_validation</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;Please provide a valid splitting method. Available options are: Random,&quot;</span>
                    <span class="s2">&quot; Stratified, TimeSeries and KFold.&quot;</span><span class="p">)</span>







<div class="viewcode-block" id="SplitData.random"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SplitData.random">[docs]</a>    <span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Randomly split the data into training, validation, and test sets.</span>

<span class="sd">        :return: Training, validation, and test data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">num_test</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_test</span><span class="p">):</span>

            <span class="n">rand_num</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">rand_num</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">test_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>

            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">num_validation</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validation</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_validation</span><span class="p">):</span>

                <span class="n">rand_num</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">rand_num</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">validation_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span> <span class="o">=</span> <span class="n">data</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">validation_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_data</span></div>








<div class="viewcode-block" id="SplitData.stratified"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SplitData.stratified">[docs]</a>    <span class="k">def</span> <span class="nf">stratified</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stratified split the data into training, validation, and test sets.</span>

<span class="sd">        :return: Training, validation, and test data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">classified_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

        <span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">validation_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classified_data</span><span class="p">)):</span>
            <span class="n">subset</span> <span class="o">=</span> <span class="n">classified_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="c1"># Calculate the number of samples for each set</span>
            <span class="n">num_test</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">)</span>
            <span class="n">num_validation</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>
                <span class="n">num_validation</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">validation</span><span class="p">)</span>

            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">subset</span><span class="p">))</span>

            <span class="n">test_data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">subset</span><span class="p">[:</span><span class="n">num_test</span><span class="p">])</span>
            <span class="n">validation_data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">subset</span><span class="p">[</span><span class="n">num_test</span><span class="p">:</span><span class="n">num_test</span> <span class="o">+</span> <span class="n">num_validation</span><span class="p">])</span>
            <span class="n">train_data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">subset</span><span class="p">[</span><span class="n">num_test</span> <span class="o">+</span> <span class="n">num_validation</span><span class="p">:])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span> <span class="o">=</span> <span class="n">train_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation_data</span> <span class="o">=</span> <span class="n">validation_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_data</span> <span class="o">=</span> <span class="n">test_data</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">validation_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_data</span></div>







<div class="viewcode-block" id="SplitData.time_series"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SplitData.time_series">[docs]</a>    <span class="k">def</span> <span class="nf">time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Split the data into training, validation, and test sets based on time series.</span>

<span class="sd">        :return: Training, validation, and test data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
        <span class="n">sorted_data</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">num_test</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>

            <span class="n">num_validation</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">validation</span><span class="p">)</span>
            <span class="n">num_training</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">num_test</span> <span class="o">+</span> <span class="n">num_validation</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:</span> <span class="n">num_training</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validation_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[</span><span class="n">num_training</span><span class="p">:</span> <span class="n">num_training</span> <span class="o">+</span> <span class="n">num_validation</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[</span><span class="n">num_training</span> <span class="o">+</span> <span class="n">num_validation</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_training</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">)</span> <span class="o">-</span> <span class="n">num_test</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:</span> <span class="n">num_training</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[</span><span class="n">num_training</span><span class="p">:]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">validation_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_data</span></div>







<div class="viewcode-block" id="SplitData.cross_validation"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SplitData.cross_validation">[docs]</a>    <span class="k">def</span> <span class="nf">cross_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform K-fold cross-validation and split the data into training and test sets.</span>

<span class="sd">        :return: Training, validation, and test data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

        <span class="n">len_test</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="n">len_validation</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>
            <span class="n">len_validation</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validation</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>

        <span class="n">k_sets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">training</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">validation</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">test</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_folds</span><span class="p">):</span>
            <span class="n">copied_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">test_set</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_set</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">len_test</span><span class="p">:</span>
                <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">copied_data</span><span class="p">)</span>
                <span class="n">rand_num</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">copied_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">copied_data</span><span class="p">[</span><span class="n">rand_num</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k_sets</span><span class="p">:</span>
                    <span class="n">test_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="n">k_sets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="n">copied_data</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">len_validation</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">validation_set</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_validation</span><span class="p">):</span>
                    <span class="n">rand_num</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">copied_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="n">copied_data</span><span class="p">[</span><span class="n">rand_num</span><span class="p">]</span>

                    <span class="n">validation_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="n">copied_data</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

                <span class="n">validation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">validation_set</span><span class="p">)</span>
            <span class="n">test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_set</span><span class="p">)</span>
            <span class="n">training</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copied_data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span> <span class="o">=</span> <span class="n">training</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation_data</span> <span class="o">=</span> <span class="n">validation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_data</span> <span class="o">=</span> <span class="n">test</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">validation_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_data</span></div></div>







<div class="viewcode-block" id="MissingValue"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.MissingValue">[docs]</a><span class="k">class</span> <span class="nc">MissingValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for handling missing values in a pandas DataFrame.</span>

<span class="sd">    :param data: str or pandas.DataFrame</span>
<span class="sd">        The data source, which can be a file path to a CSV or a pandas DataFrame.</span>
<span class="sd">    :param replace: str, optional</span>
<span class="sd">        The method to replace missing values. Default is &#39;Mean&#39;.</span>
<span class="sd">    :param rep_value: str or numeric, optional</span>
<span class="sd">        The replacement value to use when &#39;replace&#39; is &#39;Value&#39;. Default is None.</span>
<span class="sd">    :param rep_str: str, optional</span>
<span class="sd">        The replacement string to use when &#39;replace&#39; is &#39;Str&#39;. Default is &#39;not defined&#39;.</span>

<span class="sd">    Methods:</span>
<span class="sd">    -------------------</span>
<span class="sd">    load_data():</span>
<span class="sd">        Load the data source as a pandas DataFrame.</span>

<span class="sd">    numerical():</span>
<span class="sd">        Replace missing values in numeric columns using specified method.</span>

<span class="sd">    qualitative():</span>
<span class="sd">        Replace missing values in qualitative (categorical) columns using specified method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="s1">&#39;Mean&#39;</span><span class="p">,</span> <span class="n">rep_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rep_str</span><span class="o">=</span><span class="s1">&#39;not defined&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a MissingValue instance.</span>

<span class="sd">        :param data: str or pandas.DataFrame. The data source.</span>
<span class="sd">        :param replace: str, optional. The method to replace missing values.</span>
<span class="sd">         Default is &#39;Mean&#39;.</span>
<span class="sd">        :param rep_value: str or numeric, optional. The replacement value to use when &#39;replace&#39; is &#39;Value&#39;.</span>
<span class="sd">         Default is None.</span>
<span class="sd">        :param rep_str: str, optional. The replacement string to use when &#39;replace&#39; is &#39;Str&#39;.</span>
<span class="sd">         Default is &#39;not defined&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rep_value</span> <span class="o">=</span> <span class="n">rep_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replace</span> <span class="o">=</span> <span class="n">replace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rep_str</span> <span class="o">=</span> <span class="n">rep_str</span>



<div class="viewcode-block" id="MissingValue.load_data"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.MissingValue.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load the data source as a pandas DataFrame.</span>

<span class="sd">        :return: pandas.DataFrame</span>
<span class="sd">            The loaded data as a DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>




<div class="viewcode-block" id="MissingValue.numerical"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.MissingValue.numerical">[docs]</a>    <span class="k">def</span> <span class="nf">numerical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace missing values in numeric columns using the specified method.</span>

<span class="sd">        :return: pandas.DataFrame</span>
<span class="sd">            The DataFrame with missing values replaced.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># Create a copy to avoid modifying the original DataFrame</span>

        <span class="n">incomplete_cols</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">incomplete_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace</span> <span class="o">==</span> <span class="s2">&quot;Mean&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">incomplete_cols</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace</span> <span class="o">==</span> <span class="s2">&quot;Null&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">incomplete_cols</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace</span> <span class="o">==</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">incomplete_cols</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rep_value</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace</span> <span class="o">==</span> <span class="s2">&quot;Del&quot;</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please select a valid &#39;replace&#39; option. &quot;</span>
                             <span class="s2">&quot;Available choices include: &#39;Mean,&#39; &#39;Null,&#39; &#39;Value,&#39; and &#39;Del.&#39;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>  <span class="c1"># Return the modified DataFrame</span></div>





<div class="viewcode-block" id="MissingValue.qualitative"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.MissingValue.qualitative">[docs]</a>    <span class="k">def</span> <span class="nf">qualitative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace missing values in qualitative (categorical) columns using the specified method.</span>

<span class="sd">        :return: pandas.DataFrame</span>
<span class="sd">            The DataFrame with missing values replaced.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">incomplete_cols</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">incomplete_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace</span> <span class="o">==</span> <span class="s2">&quot;Str&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">incomplete_cols</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rep_str</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace</span> <span class="o">==</span> <span class="s2">&quot;Del&quot;</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please select a valid &#39;replace&#39; option.&quot;</span>
                             <span class="s2">&quot; Available choices include: &#39;Del&#39; and &#39;Str&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span></div></div>




<div class="viewcode-block" id="SelectFeature"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SelectFeature">[docs]</a><span class="k">class</span> <span class="nc">SelectFeature</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class offers six methods to select the most suitable features for predicting the target:</span>

<span class="sd">        1) Correlation Selection</span>
<span class="sd">        2) Mutual Information</span>
<span class="sd">        3) Lasso Regularization</span>
<span class="sd">        4) Recursive Feature Elimination</span>
<span class="sd">        5) Select K Best</span>
<span class="sd">        6) Variance Threshold</span>

<span class="sd">    Args:</span>
<span class="sd">        csv_file (str): The path to the CSV file containing the data.</span>
<span class="sd">        label (str): The name of the column in the data used as the label.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csv_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">csv_file</span> <span class="o">=</span> <span class="n">csv_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>  <span class="c1"># The name of the column in data, which is used as the label</span>




<div class="viewcode-block" id="SelectFeature.correlation"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SelectFeature.correlation">[docs]</a>    <span class="k">def</span> <span class="nf">correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features based on their correlation with the target label.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshold (float): The correlation threshold for feature selection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[List[str], pd.DataFrame]: A tuple containing a list of relevant</span>
<span class="sd">            features and a DataFrame with those features.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">relevant_features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">relevant_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csv_file</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">num_feature</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="n">label_index</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="n">data_corr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_feature</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">data_corr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">label_index</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>

                <span class="n">temp_rel_feature</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">relevant_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_rel_feature</span><span class="p">)</span>
                <span class="n">relevant_data</span><span class="p">[</span><span class="n">temp_rel_feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">temp_rel_feature</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">relevant_features</span><span class="p">,</span> <span class="n">relevant_data</span></div>





<div class="viewcode-block" id="SelectFeature.mutual_infos"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SelectFeature.mutual_infos">[docs]</a>    <span class="k">def</span> <span class="nf">mutual_infos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute mutual information between features and the target label.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, float]: A dictionary mapping feature names to their mutual information scores.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mutual</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csv_file</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>

                <span class="n">feature</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                <span class="n">discrete_feature</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">feature</span><span class="p">]</span>  <span class="c1"># convert values in feature to discrete values</span>
                <span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>  <span class="c1"># convert values in load_target to discrete values</span>

                <span class="n">feature_target</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">discrete_feature</span><span class="p">,</span> <span class="n">target</span><span class="p">)]</span>

                <span class="n">unique_fea_tar</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">feature_target</span><span class="p">))</span>

                <span class="n">marginal_pxs</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">marginal_pys</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">marginal_pxy</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">unique_fea_tar</span><span class="p">:</span>
                    <span class="n">marginal_pxy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_target</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_target</span><span class="p">))</span>

                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">discrete_feature</span><span class="p">):</span>
                    <span class="n">marginal_pxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">discrete_feature</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">discrete_feature</span><span class="p">))</span>

                <span class="k">for</span> <span class="n">tar</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
                    <span class="n">marginal_pys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">tar</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>

                <span class="n">mutual_info</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_fea_tar</span><span class="p">)):</span>
                    <span class="n">px</span> <span class="o">=</span> <span class="n">marginal_pxs</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_fea_tar</span><span class="p">)]</span>
                    <span class="n">py</span> <span class="o">=</span> <span class="n">marginal_pys</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_fea_tar</span><span class="p">)]</span>
                    <span class="n">pxy</span> <span class="o">=</span> <span class="n">marginal_pxy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">mutual_info</span> <span class="o">+=</span> <span class="n">pxy</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">pxy</span> <span class="o">/</span> <span class="p">(</span><span class="n">px</span> <span class="o">*</span> <span class="n">py</span><span class="p">))</span>

                <span class="n">mutual</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">mutual_info</span>

        <span class="k">return</span> <span class="n">mutual</span></div>






<div class="viewcode-block" id="SelectFeature.lasso"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SelectFeature.lasso">[docs]</a>    <span class="k">def</span> <span class="nf">lasso</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply Lasso regularization to feature coefficients for feature selection.</span>

<span class="sd">        Args:</span>
<span class="sd">            coefficients (List[float]): Coefficients of features.</span>
<span class="sd">            lam (float): Lasso regularization parameter.</span>
<span class="sd">            learning_rate (float): Learning rate for Lasso.</span>
<span class="sd">            threshold (float): Convergence threshold.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[List[float], List[float]]: A tuple containing the original coefficients and updated coefficients.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new_coefficients</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">coefficient</span> <span class="ow">in</span> <span class="n">coefficients</span><span class="p">:</span>
            <span class="n">temp_coefficient</span> <span class="o">=</span> <span class="n">coefficient</span>

            <span class="k">if</span> <span class="n">coefficient</span> <span class="o">&gt;</span> <span class="n">lam</span> <span class="o">*</span> <span class="n">learning_rate</span><span class="p">:</span>
                <span class="n">temp_coefficient</span> <span class="o">-=</span> <span class="n">lam</span> <span class="o">*</span> <span class="n">learning_rate</span>

            <span class="k">elif</span> <span class="n">coefficient</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">lam</span> <span class="o">*</span> <span class="n">learning_rate</span><span class="p">:</span>
                <span class="n">temp_coefficient</span> <span class="o">+=</span> <span class="n">lam</span> <span class="o">*</span> <span class="n">learning_rate</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">temp_coefficient</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">new_coefficients</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_coefficient</span><span class="p">)</span>

        <span class="c1"># Check convergence</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">new</span> <span class="o">-</span> <span class="n">old</span><span class="p">)</span> <span class="k">for</span> <span class="n">new</span><span class="p">,</span> <span class="n">old</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_coefficients</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">)]</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">d</span> <span class="o">&lt;</span> <span class="n">threshold</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diff</span><span class="p">):</span>

            <span class="k">return</span> <span class="n">new_coefficients</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lasso</span><span class="p">(</span><span class="n">new_coefficients</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span></div>





<div class="viewcode-block" id="SelectFeature.elimination"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SelectFeature.elimination">[docs]</a>    <span class="k">def</span> <span class="nf">elimination</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;LinearRegression&#39;</span><span class="p">,</span> <span class="n">evaluation</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features using recursive feature elimination.</span>

<span class="sd">        Args:</span>
<span class="sd">            model (str): The machine learning model to use for evaluation</span>
<span class="sd">            (&#39;LinearRegression&#39; or &#39;LogisticRegression&#39;).</span>
<span class="sd">            evaluation (str): The evaluation metric to use</span>
<span class="sd">            (&#39;accuracy&#39;, &#39;recall&#39;, &#39;precision&#39;, and &#39;MSE&#39;).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[Tuple[str], float]: A dictionary containing</span>
<span class="sd">            model performance scores for each feature subset.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">train_models</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;LinearRegression&#39;</span><span class="p">,</span> <span class="s1">&#39;LogisticRegression&#39;</span><span class="p">,</span> <span class="s1">&#39;DecisionTree&#39;</span><span class="p">]</span>
        <span class="n">eva_models</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;MSE&#39;</span><span class="p">]</span>

        <span class="n">load_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csv_file</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">load_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
                <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

        <span class="n">model_scores</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>

            <span class="n">split</span> <span class="o">=</span> <span class="n">SplitData</span><span class="p">(</span><span class="n">load_data</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">train_set</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">test_set</span> <span class="o">=</span> <span class="n">split</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

            <span class="n">test_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">feature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">test_set</span><span class="p">])</span>
            <span class="n">test_label</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">test_data</span><span class="p">]</span>

            <span class="n">predicted</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">feature_importance</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">evaluate</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">train_models</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;LinearRegression&#39;</span><span class="p">:</span>
                    <span class="n">train_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">train_set</span><span class="p">)</span>
                    <span class="n">train_model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
                    <span class="n">feature_importance</span> <span class="o">=</span> <span class="n">train_model</span><span class="o">.</span><span class="n">coefficients</span>
                    <span class="n">predicted</span> <span class="o">=</span> <span class="n">train_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
                        <span class="n">data</span><span class="o">=</span><span class="n">test_data</span><span class="p">,</span>
                        <span class="n">norm</span><span class="o">=</span><span class="n">norm</span>
                    <span class="p">)</span>

                <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;LogisticRegression&#39;</span><span class="p">:</span>
                    <span class="n">train_model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">train_set</span><span class="p">)</span>
                    <span class="n">train_model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
                    <span class="n">predicted</span> <span class="o">=</span> <span class="n">train_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
                    <span class="n">feature_importance</span> <span class="o">=</span> <span class="n">train_model</span><span class="o">.</span><span class="n">coefficients</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please choose a valid train model. Available models are:&quot;</span>
                                 <span class="s2">&quot; &#39;LinearRegression&#39; and &#39;LogisticRegression&#39;.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">evaluation</span> <span class="ow">in</span> <span class="n">eva_models</span><span class="p">:</span>
                <span class="n">eva_model</span> <span class="o">=</span> <span class="n">Validation</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">evaluation</span> <span class="o">==</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span>
                    <span class="n">evaluate</span> <span class="o">=</span> <span class="n">eva_model</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">test_label</span><span class="p">,</span> <span class="n">predicted</span><span class="o">=</span><span class="n">predicted</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">evaluation</span> <span class="o">==</span> <span class="s1">&#39;recall&#39;</span><span class="p">:</span>
                    <span class="n">eva_model</span> <span class="o">=</span> <span class="n">eva_model</span><span class="o">.</span><span class="n">recall</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">test_label</span><span class="p">,</span> <span class="n">predicted</span><span class="o">=</span><span class="n">predicted</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">evaluation</span> <span class="o">==</span> <span class="s1">&#39;precision&#39;</span><span class="p">:</span>
                    <span class="n">eva_model</span> <span class="o">=</span> <span class="n">eva_model</span><span class="o">.</span><span class="n">precision</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">test_label</span><span class="p">,</span> <span class="n">predicted</span><span class="o">=</span><span class="n">predicted</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">evaluation</span> <span class="o">==</span> <span class="s1">&#39;MSE&#39;</span><span class="p">:</span>
                    <span class="n">eva_model</span> <span class="o">=</span> <span class="n">eva_model</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">actual</span><span class="o">=</span><span class="n">test_label</span><span class="p">,</span> <span class="n">predicted</span><span class="o">=</span><span class="n">predicted</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please choose a valid evaluation model. Available models are:&quot;</span>
                                 <span class="s2">&quot; &#39;accuracy&#39;, &#39;recall&#39;, &#39;precision&#39;, ... .&quot;</span><span class="p">)</span>

            <span class="n">model_scores</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">features</span><span class="p">)]</span> <span class="o">=</span> <span class="n">evaluate</span>

            <span class="n">eliminated_feature</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">feature_importance</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">feature_importance</span><span class="p">))]</span>
            <span class="n">load_data</span> <span class="o">=</span> <span class="n">load_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">eliminated_feature</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">features</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">eliminated_feature</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">model_scores</span></div>





<div class="viewcode-block" id="SelectFeature.best_features"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SelectFeature.best_features">[docs]</a>    <span class="k">def</span> <span class="nf">best_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;numerical&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select the best &#39;k&#39; features based on their importance.</span>

<span class="sd">        Args:</span>
<span class="sd">            k (int): The number of best features to select.</span>
<span class="sd">            data_type (str): The data type (&#39;numerical&#39; or &#39;categorical&#39;).</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[str]: A list of the best &#39;k&#39; features.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">load_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csv_file</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">features_name</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">load_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">feature</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
                <span class="n">features_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
                <span class="n">features</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span>

        <span class="n">target_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">load_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

        <span class="n">best_features</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;numerical&#39;</span><span class="p">:</span>
            <span class="n">f_scores</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">features_name</span><span class="p">:</span>
                <span class="n">f_statistic</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">f_oneway</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">target_values</span><span class="p">)</span>
                <span class="n">f_scores</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">f_statistic</span><span class="p">))</span>

            <span class="n">sorted_f_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">f_scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">best_features</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">feature</span> <span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sorted_f_scores</span><span class="p">[:</span><span class="n">k</span><span class="p">]])</span>

        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;categorical&#39;</span><span class="p">:</span>
            <span class="n">contingency_tables</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">features_name</span><span class="p">:</span>
                <span class="n">contingency_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">target_values</span><span class="p">)</span>
                <span class="n">contingency_tables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">contingency_table</span>

            <span class="n">chi2_stats</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">contingency_tables</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">chi2</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
                <span class="n">chi2_stats</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">feature</span><span class="p">,</span> <span class="n">chi2</span><span class="p">))</span>

            <span class="n">sorted_chi2_stats</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chi2_stats</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">best_features</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">feature</span> <span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sorted_chi2_stats</span><span class="p">[:</span><span class="n">k</span><span class="p">]])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please choose a valid data_type: available data_types are: &#39;numerical&#39; and &#39;categorical&#39;.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">best_features</span></div>





<div class="viewcode-block" id="SelectFeature.variance_threshold"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.SelectFeature.variance_threshold">[docs]</a>    <span class="k">def</span> <span class="nf">variance_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove features with variance below the specified threshold.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshold (float): The threshold for feature variance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: The data with low-variance features removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">load_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csv_file</span><span class="p">)</span>

        <span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">load_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">feature</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
                <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>

            <span class="n">variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">load_data</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">variance</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>

                <span class="n">load_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">load_data</span></div></div>


<div class="viewcode-block" id="CategoricalData"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.CategoricalData">[docs]</a><span class="k">class</span> <span class="nc">CategoricalData</span><span class="p">:</span>

<div class="viewcode-block" id="CategoricalData.l_encoding"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.CategoricalData.l_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">l_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nums</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Label Encoding: Assigns a unique integer to each category. Suitable for</span>
<span class="sd">        ordinal categorical variables with a meaningful order.</span>

<span class="sd">        :param data: Input DataFrame containing categorical data.</span>
<span class="sd">        :param labels: Optional custom labels to use for encoding.</span>
<span class="sd">        :param nums: Optional list of integers to use for encoding.</span>
<span class="sd">        :param index: Optional custom index to start numbering from.</span>
<span class="sd">        :return: DataFrame with label-encoded categorical data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">labeled_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">labels</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">nums</span><span class="p">:</span>
                <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">+</span> <span class="n">index</span><span class="p">)]</span>
                <span class="n">labels_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">label</span><span class="p">:</span> <span class="n">num</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">nums</span><span class="p">)}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">label</span><span class="p">:</span> <span class="n">num</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">nums</span><span class="p">)}</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
            <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))]</span>
            <span class="n">labels_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">label</span><span class="p">:</span> <span class="n">num</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">nums</span><span class="p">)}</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">mapped_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">labels_dict</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
            <span class="n">labeled_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">mapped_labels</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">labeled_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalData.onehot_encoding"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.CategoricalData.onehot_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">onehot_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">yes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        One-Hot Encoding: Creates binary columns for each category.</span>
<span class="sd">        Suitable for nominal categorical variables without a meaningful order.</span>

<span class="sd">        :param data: Input DataFrame containing categorical data.</span>
<span class="sd">        :param yes: Value to use for encoding category presence (default: 1).</span>
<span class="sd">        :param no: Value to use for encoding absence of category (default: 0).</span>
<span class="sd">        :return: DataFrame with one-hot encoded categorical data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">labeled_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">yes</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">yes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">no</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">no</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">temp_cols</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>

                <span class="n">new_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">label</span> <span class="k">else</span> <span class="n">j</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">temp_cols</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_col</span>

            <span class="n">labeled_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">temp_cols</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">labeled_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalData.bin_encoding"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.CategoricalData.bin_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">bin_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nums</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary Encoding: Represents each category with binary code, combining label</span>
<span class="sd">        and one-hot encoding. Efficient for high-cardinality features.</span>

<span class="sd">        :param data: Input DataFrame containing categorical data.</span>
<span class="sd">        :param labels: Optional custom labels to use for encoding.</span>
<span class="sd">        :param nums: Optional binary encoding values for labels.</span>
<span class="sd">        :param index: Optional custom index to start binary encoding from.</span>
<span class="sd">        :return: DataFrame with binary encoded categorical data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">labeled_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nums</span><span class="p">:</span>
            <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">+</span> <span class="n">index</span><span class="p">)]</span>  <span class="c1"># Remove the &#39;0b&#39; prefix from the binary numbers</span>
            <span class="n">labels_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">nums</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">labels</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">:</span>
            <span class="n">bin_nums</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">num</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">]</span>
            <span class="n">labels_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">bin_nums</span><span class="p">))</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">labels</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
            <span class="n">bin_nums</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">num</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">]</span>
            <span class="n">labels_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">bin_nums</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
            <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))]</span>
            <span class="n">labels_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">nums</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">mapped_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">labels_dict</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
            <span class="n">labeled_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">mapped_labels</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">labeled_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="CategoricalData.count_encoding"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.CategoricalData.count_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">count_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Count Encoding: Replaces each category with its occurrence</span>
<span class="sd">        count in the dataset. Captures category prevalence information.</span>

<span class="sd">        :param data: Input DataFrame containing categorical data.</span>
<span class="sd">        :return: DataFrame with count-encoded categorical data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">labeled_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

            <span class="n">encoded_col</span> <span class="o">=</span> <span class="p">[(</span><span class="n">label</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">label</span><span class="p">))</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

            <span class="n">labeled_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoded_col</span>

        <span class="k">return</span> <span class="n">labeled_data</span></div>

<div class="viewcode-block" id="CategoricalData.mean_encoding"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.CategoricalData.mean_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">mean_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mean Encoding (Target Encoding): Replaces categories with the mean</span>
<span class="sd">        of the target variable for that category. Captures feature-target relationship.</span>

<span class="sd">        :param data: Input DataFrame containing categorical data.</span>
<span class="sd">        :param target: Optional target variable for encoding.</span>
<span class="sd">                       If not provided, unique target values from the data will be used.</span>
<span class="sd">        :return: DataFrame with target-encoded categorical data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">target</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">target</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
            <span class="n">target</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
            <span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">))]</span>

        <span class="n">labeled_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">temp_dict</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

            <span class="n">temp_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">target</span><span class="p">)]</span>

            <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>

                <span class="n">mean_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">temp_list</span> <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">label</span><span class="p">])</span>

                <span class="n">temp_dict</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_value</span>

            <span class="n">labeled_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_dict</span>

        <span class="k">return</span> <span class="n">labeled_data</span></div>

<div class="viewcode-block" id="CategoricalData.freq_encoding"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.CategoricalData.freq_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">freq_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Frequency Encoding: Replaces categories with their frequency in the dataset.</span>
<span class="sd">        Suitable for nominal categorical features.</span>

<span class="sd">        :param data: Input DataFrame containing categorical data.</span>
<span class="sd">        :param r: Number of decimal places to round the frequency values.</span>
<span class="sd">        :return: DataFrame with frequency-encoded categorical data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">labeled_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>

            <span class="n">encoded_col</span> <span class="o">=</span> <span class="p">[(</span><span class="n">label</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)),</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

            <span class="n">labeled_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoded_col</span>

        <span class="k">return</span> <span class="n">labeled_data</span></div></div>




<div class="viewcode-block" id="FeatureScaling"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.FeatureScaling">[docs]</a><span class="k">class</span> <span class="nc">FeatureScaling</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    In this class, there are 9 different normalization methods for numeric data:</span>

<span class="sd">    1) Min-max scaling</span>
<span class="sd">    2) Standardization (Z-score normalization)</span>
<span class="sd">    3) Robust scaling</span>
<span class="sd">    4) Max-Absolute scaling</span>
<span class="sd">    5) Power transformation</span>
<span class="sd">    6) Unit Vector Scaling (L2 Normalization)</span>
<span class="sd">    7) Log transformation</span>
<span class="sd">    8) Box-Cox transformation</span>
<span class="sd">    9) Yeo-Johnson transformation</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="FeatureScaling.min_max"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.FeatureScaling.min_max">[docs]</a>    <span class="k">def</span> <span class="nf">min_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Min-Max scaling (Normalization).</span>

<span class="sd">        :param data: Input DataFrame containing numeric data.</span>
<span class="sd">        :param columns: List of columns to normalize.</span>
<span class="sd">                        If None, all numeric columns are selected.</span>
<span class="sd">        :return: DataFrame with Min-Max normalized data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">norm_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
                    <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">norm_col</span> <span class="o">=</span> <span class="p">[(</span><span class="n">value</span> <span class="o">-</span> <span class="n">min_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_val</span> <span class="o">-</span> <span class="n">min_val</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm_col</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="FeatureScaling.z_score"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.FeatureScaling.z_score">[docs]</a>    <span class="k">def</span> <span class="nf">z_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Standardization (Z-score normalization).</span>

<span class="sd">        :param data: Input DataFrame containing numeric data.</span>
<span class="sd">        :param columns: List of columns to standardize.</span>
<span class="sd">                        If None, all numeric columns are selected.</span>
<span class="sd">        :return: DataFrame with Z-score standardized data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">norm_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>

                <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>

                    <span class="n">mean_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">std_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

                    <span class="n">norm_col</span> <span class="o">=</span> <span class="p">[(</span><span class="n">value</span> <span class="o">-</span> <span class="n">mean_val</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_val</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm_col</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="FeatureScaling.robust"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.FeatureScaling.robust">[docs]</a>    <span class="k">def</span> <span class="nf">robust</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Robust scaling.</span>

<span class="sd">        :param data: Input DataFrame containing numeric data.</span>
<span class="sd">        :param columns: List of columns to scale robustly.</span>
<span class="sd">                        If None, all numeric columns are selected.</span>
<span class="sd">        :return: DataFrame with robustly scaled data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">norm_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>

                <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>

                    <span class="n">med_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
                    <span class="n">q3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
                    <span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>

                    <span class="n">norm_col</span> <span class="o">=</span> <span class="p">[(</span><span class="n">val</span> <span class="o">-</span> <span class="n">med_val</span><span class="p">)</span> <span class="o">/</span> <span class="n">iqr</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm_col</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="FeatureScaling.abs_max"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.FeatureScaling.abs_max">[docs]</a>    <span class="k">def</span> <span class="nf">abs_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Max-Absolute scaling.</span>

<span class="sd">        :param data: Input DataFrame containing numeric data.</span>
<span class="sd">        :param columns: List of columns to scale using Max-Absolute scaling.</span>
<span class="sd">                        If None, all numeric columns are selected.</span>
<span class="sd">        :return: DataFrame with Max-Absolute scaled data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">norm_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>

                <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>

                    <span class="n">abs_max</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>

                    <span class="n">norm_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="o">/</span> <span class="n">abs_max</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm_col</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="FeatureScaling.pow_transform"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.FeatureScaling.pow_transform">[docs]</a>    <span class="k">def</span> <span class="nf">pow_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Power transformation.</span>

<span class="sd">        :param data: Input DataFrame containing numeric data.</span>
<span class="sd">        :param lam: Lambda value for the power transformation.</span>
<span class="sd">        :param columns: List of columns to apply the power transformation.</span>
<span class="sd">                        If None, all numeric columns are selected.</span>
<span class="sd">        :return: DataFrame with power-transformed data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">norm_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>

                <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>

                    <span class="n">norm_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">lam</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm_col</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="FeatureScaling.unit_vector"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.FeatureScaling.unit_vector">[docs]</a>    <span class="k">def</span> <span class="nf">unit_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unit Vector Scaling (L2 Normalization).</span>

<span class="sd">        :param data: Input DataFrame containing numeric data.</span>
<span class="sd">        :param columns: List of columns to apply L2 normalization.</span>
<span class="sd">                        If None, all numeric columns are selected.</span>
<span class="sd">        :return: DataFrame with unit vector scaled data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">norm_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
                <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>

        <span class="n">norm_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span>

        <span class="n">norms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">norm_df</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">normalized_data</span> <span class="o">=</span> <span class="n">norm_df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">norms</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                <span class="n">normalized_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">normalized_data</span></div>


<div class="viewcode-block" id="FeatureScaling.log_transform"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.FeatureScaling.log_transform">[docs]</a>    <span class="k">def</span> <span class="nf">log_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Log transformation.</span>

<span class="sd">        :param data: Input DataFrame containing numeric data.</span>
<span class="sd">        :param columns: List of columns to apply the log transformation.</span>
<span class="sd">                        If None, all numeric columns are selected.</span>
<span class="sd">        :return: DataFrame with log-transformed data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">norm_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>

                <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>

                    <span class="c1"># Add a small constant to avoid logarithm of 0</span>
                    <span class="n">norm_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">val</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm_col</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="FeatureScaling.box_cox"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.FeatureScaling.box_cox">[docs]</a>    <span class="k">def</span> <span class="nf">box_cox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Box-Cox transformation.</span>

<span class="sd">        :param data: Input DataFrame containing numeric data.</span>
<span class="sd">        :param lam: Lambda value for the Box-Cox transformation.</span>
<span class="sd">        :param columns: List of columns to apply the Box-Cox transformation.</span>
<span class="sd">                        If None, all numeric columns are selected.</span>
<span class="sd">        :return: DataFrame with Box-Cox transformed data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">norm_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>

                <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>

                    <span class="n">norm_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">lam</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">lam</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm_col</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="FeatureScaling.yeo_johnson"><a class="viewcode-back" href="../../smartsolve.html#smartsolve.preprocessing.FeatureScaling.yeo_johnson">[docs]</a>    <span class="k">def</span> <span class="nf">yeo_johnson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Yeo-Johnson transformation.</span>

<span class="sd">        :param data: Input DataFrame containing numeric data.</span>
<span class="sd">        :param lam: Lambda value for the Yeo-Johnson transformation.</span>
<span class="sd">        :param columns: List of columns to apply the Yeo-Johnson transformation.</span>
<span class="sd">                        If None, all numeric columns are selected.</span>
<span class="sd">        :return: DataFrame with Yeo-Johnson transformed data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">norm_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>

                <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>

                    <span class="n">norm_col</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">lam</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">norm_col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">lam</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">lam</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">lam</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">norm_col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">lam</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">lam</span><span class="p">))</span>

                        <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">lam</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">norm_col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

                        <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">lam</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">norm_col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="n">value</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">norm_col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm_col</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="n">norm_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span></div></div>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Loghman Samani.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>